<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>

<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"><title>libtcod documentation | line drawing toolkit</title>

<link href="../../css/style.css" rel="stylesheet" type="text/css"></head><body>
<div class="header">
<p><span class="title1">libtcod</span><span class="title2">documentation</span></p>
</div>
<div class="breadcrumb">
<div class="breadcrumbtext">
<p>you are here: <a href="../../index.html">Index</a>
&gt; <a href="index.html">4. Line drawing toolkit</a><br>
<a class="prev" href="../system/index.html">3. System layer</a> | <a class="next" href="../image/index.html">5. Image toolkit</a></p>
</div>
</div>
<div class="main">
<div class="maintext">
<p>This toolkit is a very simple and lightweight implementation of the
bresenham line drawing algorithm. It allows you to follow straight
paths on your map very easily.</p>
<p>First, you have to initialize the toolkit with your starting and ending coordinates:</p>

<div class="code">
	<p class="cpp"><span class="code-keyword">static void</span>&nbsp;<span class="code-tcod">TCODLine</span><span class="code-symbol">::</span>init&nbsp;<span class="code-symbol">(</span><span class="code-keyword">int</span> xFrom<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> yFrom<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> xTo<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> yTo<span class="code-symbol">)</span></p>
	<p class="c"><span class="code-keyword">void</span>&nbsp;TCOD_line_init&nbsp;<span class="code-symbol">(</span><span class="code-keyword">int</span> xFrom<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> yFrom<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> xTo<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> yTo<span class="code-symbol">)</span></p>
	<p class="py">line_init&nbsp;<span class="code-symbol">(</span>xFrom<span class="code-symbol">,</span> yFrom<span class="code-symbol">,</span> xTo<span class="code-symbol">,</span> yTo<span class="code-symbol">)</span></p>
</div>

<table class="param">
<tbody><tr><th>Parameter</th><th>Description</th></tr>
<tr class="hilite"><td>xFrom, yFrom</td><td>Coordinates of the line's starting point.</td></tr>
<tr><td>xTo, yTo</td><td>Coordinates of the line's ending point.</td></tr>
</tbody></table>

<p>You can then step through each cell with this function. It returns true when you reach the line's ending point.</p>

<div class="code">	
<p class="cpp"><span class="code-keyword">static bool</span>&nbsp;<span class="code-tcod">TCODLine</span><span class="code-symbol">::</span>step&nbsp;<span class="code-symbol">(</span><span class="code-keyword">int</span>&nbsp;<span class="code-symbol">*</span> xCur<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span>&nbsp;<span class="code-symbol">*</span> yCur<span class="code-symbol">)</span></p>
<p class="c"><span class="code-keyword">bool</span>&nbsp;TCOD_line_step&nbsp;<span class="code-symbol">(</span><span class="code-keyword">int</span>&nbsp;<span class="code-symbol">*</span> xCur<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span>&nbsp;<span class="code-symbol">*</span> yCur<span class="code-symbol">)</span></p>
<p class="py">line_step&nbsp;<span class="code-symbol">()</span>&nbsp;<span class="code-comment"># returns x,y or None,None if finished</span></p>
</div>

<table class="param">
<tbody><tr><th>Parameter</th><th>Description</th></tr>
<tr class="hilite"><td>xCur, yCur</td><td>Coordinates of the next cell on the line.</td></tr>
</tbody></table>

<h6>Example:</h6>
<p>Going from point 5,8 to point 13,4:</p>

<div class="code">
<p class="cpp">
<span class="code-keyword">int</span>&nbsp;x&nbsp;<span class="code-symbol">=</span>&nbsp;<span class="code-value">5</span><span class="code-symbol">,</span> y&nbsp;<span class="code-symbol">=</span>&nbsp;<span class="code-value">8</span><span class="code-symbol">;</span><br>
<span class="code-tcod">TCODLine</span><span class="code-symbol">::</span>init<span class="code-symbol">(</span>x<span class="code-symbol">,</span>y<span class="code-symbol">,</span><span class="code-value">13</span><span class="code-symbol">,</span><span class="code-value">4</span><span class="code-symbol">);</span><br><span class="code-keyword">do</span>&nbsp;<span class="code-symbol">{</span><br>
&nbsp; &nbsp;&nbsp;<span class="code-comment">// update cell x,y</span><br><span class="code-symbol">}</span>&nbsp;<span class="code-keyword">while</span>&nbsp;<span class="code-symbol">(!</span><span class="code-tcod">TCODLine</span><span class="code-symbol">::</span>step<span class="code-symbol">(&amp;</span>x<span class="code-symbol">,&amp;</span>y<span class="code-symbol">));</span></p>
<p class="c">
<span class="code-keyword">int</span>&nbsp;x&nbsp;<span class="code-symbol">=</span>&nbsp;<span class="code-value">5</span><span class="code-symbol">,</span> y&nbsp;<span class="code-symbol">=</span>&nbsp;<span class="code-value">8</span><span class="code-symbol">;</span><br>
TCOD_line_init<span class="code-symbol">(</span>x<span class="code-symbol">,</span>y<span class="code-symbol">,</span><span class="code-value">13</span><span class="code-symbol">,</span><span class="code-value">4</span><span class="code-symbol">);</span><br>
<span class="code-keyword">do</span>&nbsp;<span class="code-symbol">{</span><br>
&nbsp; &nbsp;&nbsp;<span class="code-comment">/* update cell x,y */</span><br><span class="code-symbol">}</span>&nbsp;<span class="code-keyword">while</span>&nbsp;<span class="code-symbol">(!</span>TCOD_line_step<span class="code-symbol">(&amp;</span>x<span class="code-symbol">,&amp;</span>y<span class="code-symbol">));</span></p>
<p class="py">
libtcod<span class="code-symbol">.</span>line_init<span class="code-symbol">(</span><span class="code-value">5</span><span class="code-symbol">,</span><span class="code-value">8</span><span class="code-symbol">,</span><span class="code-value">13</span><span class="code-symbol">,</span><span class="code-value">4</span><span class="code-symbol">)</span><br><span class="code-comment"># update cell 5,8</span><br>
x<span class="code-symbol">,</span>y<span class="code-symbol">=</span>libtcod<span class="code-symbol">.</span>line_step<span class="code-symbol">()</span><br>
<span class="code-keyword">while</span>&nbsp;<span class="code-symbol">(</span><span class="code-keyword">not</span> x&nbsp;<span class="code-keyword">is None</span><span class="code-symbol">) :</span><br>
&nbsp; &nbsp;&nbsp;<span class="code-comment"># update cell x,y</span><br>
x<span class="code-symbol">,</span>y<span class="code-symbol">=</span>libtcod<span class="code-symbol">.</span>line_step<span class="code-symbol">()</span></p>
</div>

<hr>

<p>You can also use a callback-based atomic function.</p>

<div class="code">
  <p class="cpp"><span class="code-keyword">class</span>&nbsp;<span class="code-tcod">TCODLIB_API</span>&nbsp;<span class="code-tcod">TCODLineListener</span>&nbsp;<span class="code-symbol">{</span><br>
		&nbsp; &nbsp;&nbsp;<span class="code-keyword">virtual bool</span> putPoint&nbsp;<span class="code-symbol">(</span><span class="code-keyword">int</span> x<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> y<span class="code-symbol">) =</span>&nbsp;<span class="code-value">0</span><span class="code-symbol">;</span><br><span class="code-symbol">};</span><br><span class="code-keyword">static bool</span>&nbsp;<span class="code-tcod">TCODLine</span><span class="code-symbol">::</span>line&nbsp;<span class="code-symbol">(</span><span class="code-keyword">int</span> xFrom<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> yFrom<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> xTo<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> yTo<span class="code-symbol">,</span>&nbsp;<span class="code-tcod">TCODLineListener</span>&nbsp;<span class="code-symbol">*</span> listener<span class="code-symbol">)</span></p>
	<p class="c"><span class="code-keyword">typedef bool</span>&nbsp;<span class="code-symbol">(*</span><span class="code-tcod">TCOD_line_listener_t</span><span class="code-symbol">)</span>&nbsp;<span class="code-symbol">(</span><span class="code-keyword">int</span> x<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> y<span class="code-symbol">);</span><br>
		<span class="code-keyword">bool</span>&nbsp;TCOD_line<span class="code-symbol">(</span><span class="code-keyword">int</span> xFrom<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> yFrom<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> xTo<span class="code-symbol">,</span>&nbsp;<span class="code-keyword">int</span> yTo<span class="code-symbol">,</span>&nbsp;<span class="code-tcod">TCOD_line_listener_t</span> listener<span class="code-symbol">)</span></p>
	<p class="py"><span class="code-keyword">def</span>&nbsp;line_listener<span class="code-symbol">(</span>x<span class="code-symbol">,</span>y<span class="code-symbol">) :</span>&nbsp;<span class="code-comment"># ...</span><br>
		line<span class="code-symbol">(</span>xFrom<span class="code-symbol">,</span> yFrom<span class="code-symbol">,</span> xTo<span class="code-symbol">,</span> yTo<span class="code-symbol">,</span> listener<span class="code-symbol">)</span></p>
</div>

<table class="param">
<tbody><tr><th>Parameter</th><th>Description</th></tr>
<tr class="hilite"><td>xFrom, yFrom</td><td>Coordinates of the line's starting point.</td></tr>
<tr><td>xTo, yTo</td><td>Coordinates of the line's ending point.</td></tr>
<tr class="hilite"><td>listener</td><td>Callback called for each line's point. The function stops if the callback returns false.</td></tr>
</tbody></table>

<p>The function returns false if the line has been interrupted by the callback (it returned false before the last point).</p>
<h6>Example:</h6>
<p>Going from point 5,8 to point 13,4:</p>

<div class="code">
<p class="cpp"><span class="code-keyword">class</span>&nbsp;MyLineListener&nbsp;<span class="code-symbol">:</span>&nbsp;<span class="code-keyword">public</span>&nbsp;<span class="code-tcod">TCODLineListener</span>&nbsp;<span class="code-symbol">{</span><br>
&nbsp; &nbsp;&nbsp;<span class="code-keyword">public</span><span class="code-symbol">:</span><br>
&nbsp; &nbsp;&nbsp;<span class="code-keyword">bool</span> putPoint<span class="code-symbol"> (</span><span class="code-keyword">int</span> x<span class="code-symbol">,</span><span class="code-keyword">int</span> y<span class="code-symbol">)</span>&nbsp;<span class="code-symbol">{</span><br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; printf&nbsp;<span class="code-symbol">(</span><span class="code-string">"%d %d\n"</span><span class="code-symbol">,</span>x<span class="code-symbol">,</span>y<span class="code-symbol">);</span><br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return true</span><span class="code-symbol">;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-symbol">}</span><br><span class="code-symbol">};</span><br>
MyLineListener myListener<span class="code-symbol">;</span><br>
<span class="code-tcod">TCODLine</span><span class="code-symbol">::</span>line<span class="code-symbol">(</span><span class="code-value">5</span><span class="code-symbol">,</span><span class="code-value">8</span><span class="code-symbol">,</span><span class="code-value">13</span><span class="code-symbol">,</span><span class="code-value">4</span><span class="code-symbol">,&amp;</span>myListener<span class="code-symbol">);</span></p>
<p class="c"><span class="code-keyword">bool</span>&nbsp;my_listener<span class="code-symbol">(</span><span class="code-keyword">int</span> x<span class="code-symbol">,</span><span class="code-keyword">int</span> y<span class="code-symbol">)</span>&nbsp;<span class="code-symbol">{</span><br>
&nbsp;&nbsp;&nbsp; printf&nbsp;<span class="code-symbol">(</span><span class="code-string">"%d %d\n"</span><span class="code-symbol">,</span>x<span class="code-symbol">,</span>y<span class="code-symbol">);</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return true</span><span class="code-symbol">;</span><br>
<span class="code-symbol">}</span><br>
TCOD_line_line<span class="code-symbol">(</span><span class="code-value">5</span><span class="code-symbol">,</span><span class="code-value">8</span><span class="code-symbol">,</span><span class="code-value">13</span><span class="code-symbol">,</span><span class="code-value">4</span><span class="code-symbol">,</span>my_listener<span class="code-symbol">);</span></p>
<p class="py"><span class="code-keyword">def</span>&nbsp;my_listener<span class="code-symbol">(</span>x<span class="code-symbol">,</span>y<span class="code-symbol">):</span><br> 
&nbsp; &nbsp; print x<span class="code-symbol">,</span>y<br>
&nbsp; &nbsp;&nbsp;<span class="code-keyword">return True</span><br>
libtcod<span class="code-symbol">.</span>line_line<span class="code-symbol">(</span><span class="code-value">5</span><span class="code-symbol">,</span><span class="code-value">8</span><span class="code-symbol">,</span><span class="code-value">13</span><span class="code-symbol">,</span><span class="code-value">4</span><span class="code-symbol">,</span>my_listener<span class="code-symbol">)</span></p></div>
</div></div></body></html>